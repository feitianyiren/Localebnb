'''
Script to extract features from the Neighborhoods

notes: make sure mongod running. use `sudo mongod` in terminal
'''

from airbnbneighborhood import AirBnBNeighborhood
import time

DB_NAME = 'airbnb'
COLL_NAME = 'neighborhoods'


def main():
    air_hood = AirBnBNeighborhood(db_name = DB_NAME, coll_name = COLL_NAME)
    hoods_dict = list(air_hood.coll.find({},{'_id':1}))

    for hood in hoods_dicts:
        hood_id = listing['_id']
        air_listing.pull_from_db(neighborhood_id=hood_id)
        air_listing.extract_and_add_features()
        print "Extracting Features for %s" % listing_id
    

if __name__ == '__main__':
    main()